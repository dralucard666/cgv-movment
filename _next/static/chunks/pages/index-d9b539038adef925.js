(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{45301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(62517)}])},62517:function(e,t,n){"use strict";n.r(t),n.d(t,{Viewer:function(){return Xe},default:function(){return Ae}});var i=n(85893),r=n(53359),o=n(712),a=n(26135),s=n(69613),l=n(55050),u=n(26173),c=n(77340),d=n(27032),f=n(16195);const p=Object.assign(Object.assign({},d.w),{createOb:{execute:(0,f.QV)((function(e,t,n,i,r){return(0,c.of)([e.createPrimitive(t,n,r,i)])})),includeThis:!0,defaultParameters:[()=>({type:"operation",identifier:"point3",children:[{type:"raw",value:0},{type:"raw",value:0},{type:"raw",value:0}]}),()=>({type:"raw",value:0}),()=>({type:"raw",value:0}),()=>({type:"operation",identifier:"point3",children:[{type:"raw",value:1},{type:"raw",value:0},{type:"raw",value:0}]})]},point3:{execute:(0,f.QV)((function(e,t,n){return(0,c.of)([new u.Vector3(e,t,n)])})),includeThis:!1,defaultParameters:[()=>({type:"raw",value:0}),()=>({type:"raw",value:0}),()=>({type:"raw",value:0})]},moveRight:{execute:(0,f.QV)((function(e,t){return(0,c.of)([e.moveRight(t)])})),includeThis:!0,defaultParameters:[()=>({type:"raw",value:10})]},moveLeft:{execute:(0,f.QV)((function(e,t){return(0,c.of)([e.moveLeft(t)])})),includeThis:!0,defaultParameters:[()=>({type:"raw",value:10})]},moveUp:{execute:(0,f.QV)((function(e,t){return(0,c.of)([e.moveUp(t)])})),includeThis:!0,defaultParameters:[()=>({type:"raw",value:10})]},moveDown:{execute:(0,f.QV)((function(e,t){return(0,c.of)([e.moveDown(t)])})),includeThis:!0,defaultParameters:[()=>({type:"raw",value:10})]},moveRotate:{execute:(0,f.QV)((function(e,t,n){return(0,c.of)([e.moveRotate(t,n)])})),includeThis:!0,defaultParameters:[()=>({type:"raw",value:0}),()=>({type:"raw",value:100})]},standStill:{execute:(0,f.QV)((function(e){return(0,c.of)([e.standStill()])})),includeThis:!0,defaultParameters:[]},distanceToStatic:{execute:(0,f.QV)((function(e){return(0,c.of)([e.staticObjectAhead()])})),includeThis:!0,defaultParameters:[]}});var m=n(9008),g=n(67294),h=n(40812),y=n(96976),x=function(){var e=(0,s.w)(),t=e.camera,n=e.gl;return(0,g.useEffect)((function(){var e=new y.z(t,n.domElement);return t.rotateX(-Math.PI/10),t.position.set(3,100,222.5),t.rotateX(-Math.PI/10),e.update(),e.minDistance=3,e.maxDistance=2e3,function(){e.dispose()}}),[t,n]),null},v=n(85769),j=n(18626),b=n(61385);function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(l){s=!0,r=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){var t=P((0,v.m)(["./textures/dirt/normal.jpg"]),1)[0],n=P((0,v.m)(["./textures/dirt/studentsreference.png"]),1)[0];n.rotation=Math.PI,n.encoding=u.sRGBEncoding,n.wrapS=u.RepeatWrapping,n.wrapT=u.RepeatWrapping,t.wrapS=u.RepeatWrapping,t.wrapT=u.RepeatWrapping;var r,o=e.world,a=null!==(r=o.rotation)&&void 0!==r?r:[0,0,0],s=(0,j.L)(o.image),l=(0,g.useRef)(null);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.o,{ref:l,rotation:a,object:s.scene,scale:o.scale,position:o.position}),(0,i.jsx)("ambientLight",{intensity:1})]})}j.L.preload("./models/bookstore.glb"),j.L.preload("./models/eth.glb"),j.L.preload("./models/zara.glb"),j.L.preload("./models/students.glb"),j.L.preload("./models/hotel.glb"),j.L.preload("./models/little.glb");var S,O=n(94371),M=n(73506),T=n(32108),I=n(21010),Y=n(82513),L=n(66974),k=n(29426);!function(e){e[e.Pedestrian=0]="Pedestrian",e[e.Cyclist=1]="Cyclist",e[e.Car=2]="Car"}(S||(S={}));const A=15;class E{constructor(e){this.staticObjects=e}createPrimitive(e,t,n,i){return new R([{position:e,time:t,direction:n}],i,this.staticObjects)}}class R extends E{constructor(e,t,n){super(n),this.position=e,this.type=t,this.staticObjects=n}moveRight(e){const t=this.position[this.position.length-1],n={position:t.position.clone().setX(t.position.x+e),time:t.time+A},i=this.returnNewTimeSteps(t,n,new u.Vector3(1,0,0)),r=structuredClone(this.position);return r.push(...i),new R(r,this.type,this.staticObjects)}moveLeft(e){const t=this.position[this.position.length-1],n={position:t.position.clone().setX(t.position.x-e),time:t.time+A},i=this.returnNewTimeSteps(t,n,new u.Vector3(-1,0,0)),r=structuredClone(this.position);return r.push(...i),new R(r,this.type,this.staticObjects)}moveUp(e){const t=this.position[this.position.length-1],n={position:t.position.clone().setZ(t.position.z+e),time:t.time+A},i=this.returnNewTimeSteps(t,n,new u.Vector3(0,0,1)),r=structuredClone(this.position);return r.push(...i),new R(r,this.type,this.staticObjects)}moveDown(e){const t=this.position[this.position.length-1],n={position:t.position.clone().setZ(t.position.z-e),time:t.time+A},i=this.returnNewTimeSteps(t,n,new u.Vector3(0,0,-1)),r=structuredClone(this.position);return r.push(...i),new R(r,this.type,this.staticObjects)}moveRotate(e,t){const n=this.position[this.position.length-1],i=this.position[this.position.length-1].direction.applyAxisAngle(new u.Vector3(0,1,0),-e/180*Math.PI),r={position:n.position.clone().add(i.multiplyScalar(t)),time:n.time+A},o=this.returnNewTimeSteps2(n,r,i.normalize()),a=structuredClone(this.position);return a.push(...o),new R(a,this.type,this.staticObjects)}standStill(){const e=this.position[this.position.length-1],t=e.time,n=structuredClone(this.position);for(let i=t+1;i<t+1+A;i++){const t=Object.assign(Object.assign({},e),{time:i});n.push(t)}return new R(n,this.type,this.staticObjects)}returnNewTimeSteps(e,t,n){const i=[],r=e.position,o=t.position.sub(r),a=e.time,s=t.time-a;for(let l=1;l<s+1;l++){const e=o.clone().multiplyScalar(l/s);i.push({time:a+l,position:r.clone().add(e),direction:n.clone()})}return i}returnNewTimeSteps2(e,t,n){const i=[],r=e.position,o=t.position.sub(r),a=e.time,s=t.time-a;for(let l=1;l<s+1;l++){const e=o.clone().multiplyScalar(l/s);i.push({time:a+l,position:r.clone().add(e),direction:n.clone()})}return i}staticObjectAhead(){const e=new u.Vector3(12,-5,0),t=(new u.Vector3(12,5,0),this.position[this.position.length-1].position),n=this.position[this.position.length-1].direction.multiplyScalar(10);new u.Vector3(0,0,0).addVectors(t,n);return new u.Vector3(0,0,0).subVectors(t,e)}}var X,C=n(14671),N=JSON.parse('[["agent_137",952,244,0,10,0,[1,0,0],"Pedestrian",[["135",20],["315",18],["45",14],["45",14],["315",14],["0",10],["0",14],["0",10],["0",14],["0",10]]],["agent_144",487,900,0,10,0,[1,0,0],"Biker",[["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20]]],["agent_145",720,894,0,10,0,[1,0,0],"Biker",[["0",20],["0",20],["0",20],["0",20],["315",20],["0",20],["0",20],["0",20],["0",20],["0",20]]],["agent_146",1079,849,0,10,0,[1,0,0],"Pedestrian",[["315",10],["0",6],["0",10],["0",6],["0",8],["0",10],["0",10],["0",12],["0",10],["45",10]]],["agent_147",1059,844,0,10,0,[1,0,0],"Pedestrian",[["315",10],["0",10],["0",8],["0",10],["315",8],["45",12],["0",8],["0",8],["45",10],["315",10]]],["agent_148",1037,827,0,10,0,[1,0,0],"Pedestrian",[["315",14],["315",12],["90",6],["315",10],["0",10],["0",14],["315",12],["45",12],["0",8],["45",12]]],["agent_149",1039,810,0,10,0,[1,0,0],"Pedestrian",[["315",10],["315",14],["0",6],["45",10],["0",12],["0",14],["0",12],["0",10],["45",12],["0",8]]],["agent_150",782,859,0,10,0,[1,0,0],"Biker",[["315",20],["45",20],["315",20],["0",20],["0",20],["0",20],["45",20],["315",20],["45",20],["0",20]]],["agent_152",423,1029,0,10,0,[1,0,0],"Pedestrian",[["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"]]],["agent_218",1198,594,0,10,0,[1,0,0],"Pedestrian",[["180",14],["0",20],["0",18],["0",16],["0",20],["45",20],["315",20],["45",18],["315",20],["0",20]]],["agent_219",1049,829,0,10,0,[1,0,0],"Pedestrian",[["315",8],["0",10],["0",8],["0",10],["0",10],["0",6],["0",8],["0",8],["0",6],["0",20]]],["agent_27",756,925,0,10,0,[1,0,0],"Pedestrian",[["0",8],["0",8],["0",8],["0",8],["0",8],["0",8],["0",6],["0",8],["45",4],["315",2],["still"]]],["agent_34",897,190,0,10,0,[1,0,0],"Pedestrian",[["135",10],["0",10],["45",10],["0",10],["0",8],["0",12],["0",6],["0",6],["315",8],["45",12]]],["agent_37",408,1018,0,10,0,[1,0,0],"Pedestrian",[["still"],["still"],["90",2],["still"],["still"],["0",2],["still"],["still"],["0",2],["still"]]],["agent_62",427,1055,0,10,0,[1,0,0],"Pedestrian",[["still"],["0",2],["0",2],["still"],["0",2],["still"],["0",2],["still"],["0",2],["315",2]]],["agent_71",599,1007,0,10,0,[1,0,0],"Pedestrian",[["270",2],["45",4],["0",4],["90",2],["315",2],["still"],["0",2],["180",2],["315",6],["0",4]]]]'),D=JSON.parse('[["agent_121",336,380,0,10,0,[1,0,0],"Pedestrian",[["270",20],["0",20],["0",20],["45",20],["315",20],["0",20],["0",20],["0",20],["45",20],["315",20],["0",20],["45",20],["0",20],["315",20],["45",20]]],["agent_122",355,378,0,10,0,[1,0,0],"Pedestrian",[["270",20],["0",20],["0",20],["45",20],["315",20],["0",20],["0",20],["0",20],["0",20],["45",20],["315",20],["45",20],["0",20],["315",20]]],["agent_123",306,98,0,10,11,[1,0,0],"Pedestrian",[["90",14],["45",16],["315",20]]],["agent_124",351,358,0,10,11,[1,0,0],"Pedestrian",[["270",20],["0",20],["0",20]]]]'),B=JSON.parse('[["agent_1",193,357,0,10,0,[1,0,0],"Pedestrian",[]],["agent_10",15,295,0,10,0,[1,0,0],"Pedestrian",[]],["agent_11",652,282,0,10,13,[1,0,0],"Pedestrian",[["180",20],["0",20],["350",20],["10",20],["350",20],["0",20]]],["agent_12",653,328,0,10,13,[1,0,0],"Pedestrian",[["150",12],["30",14],["0",18],["350",20],["0",20],["10",20]]],["agent_13",699,312,0,10,13,[1,0,0],"Pedestrian",[["200",18],["350",20],["350",20],["0",20],["0",20],["350",20]]],["agent_14",406,495,0,10,16,[1,0,0],"Pedestrian",[["350",20],["0",20],["10",20]]],["agent_15",406,446,0,10,16,[1,0,0],"Pedestrian",[["0",20],["350",20],["0",20]]],["agent_16",224,482,0,10,16,[1,0,0],"Pedestrian",[["350",20],["0",20],["0",20]]],["agent_2",129,322,0,10,0,[1,0,0],"Pedestrian",[]],["agent_3",307,386,0,10,0,[1,0,0],"Pedestrian",[["320",20],["0",20],["0",20],["0",20],["0",20],["0",20],["10",20],["0",20],["0",20],["0",20],["0",20],["0",20]]],["agent_4",431,424,0,10,0,[1,0,0],"Pedestrian",[["350",20],["10",20],["0",20],["350",20],["0",20],["0",20]]],["agent_5",535,186,0,10,0,[1,0,0],"Pedestrian",[["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"]]],["agent_6",553,179,0,10,0,[1,0,0],"Pedestrian",[["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"]]],["agent_7",602,140,0,10,0,[1,0,0],"Pedestrian",[["350",8],["20",10],["340",20],["10",20]]],["agent_8",453,198,0,10,0,[1,0,0],"Pedestrian",[["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["still"],["330",6],["170",6],["100",2],["240",2]]],["agent_9",53,360,0,10,0,[1,0,0],"Pedestrian",[]]]'),F=JSON.parse('[["agent_0",648.8844165802368,418.80828089406236,0,10,0,[1,0,0],"Pedestrian",[["180",20],["0",20],["0",20],["0",20],["10",20],["350",20],["350",20],["0",20],["0",20],["0",20],["350",20],["10",20],["0",20],["0",20],["10",20],["350",20],["10",20],["350",20],["0",20],["0",20],["0",20]]],["agent_1",643.8760404564293,397.8284542435488,0,10,0,[1,0,0],"Pedestrian",[["180",20],["0",20],["0",20],["0",20],["10",20],["350",20],["350",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["10",20],["0",20],["0",20],["0",20],["350",20]]],["agent_10",32.468893650099005,277.80294156356297,0,10,20,[1,0,0],"Pedestrian",[]],["agent_2",576.0703329341143,398.0257147943264,0,10,0,[1,0,0],"Pedestrian",[["190",20],["0",20],["0",18],["350",20],["10",20],["350",20],["10",20],["350",20],["10",20],["350",20],["10",20],["350",18],["0",20],["0",20],["10",18],["350",20],["0",18],["0",18],["0",18],["0",18]]],["agent_3",571.8324762139696,368.2367527010723,0,10,0,[1,0,0],"Pedestrian",[["190",20],["350",20],["10",20],["350",20],["0",20],["0",20],["0",20],["0",20],["10",20],["0",20],["350",20],["10",20],["0",20],["350",20],["10",20],["350",18],["10",20],["350",16],["10",18],["0",18]]],["agent_4",423.8927507107365,398.79626279327,0,10,0,[1,0,0],"Pedestrian",[["170",16],["0",18],["10",16],["350",18],["350",18],["0",18],["10",18],["0",18],["0",18],["0",20],["0",18],["0",18],["0",18],["0",18],["10",18],["350",18],["0",18],["10",16],["0",16],["0",16]]],["agent_5",396.1540521788803,438.9721934989134,0,10,0,[1,0,0],"Pedestrian",[["10",20],["350",20],["0",20],["0",20],["0",20],["0",20],["340",20],["350",20],["350",20],["0",20],["0",20],["0",20],["350",20],["0",20],["340",20],["0",20],["350",20],["10",20],["340",20],["0",20]]],["agent_6",309.85587896866105,423.0257013423359,0,10,0,[1,0,0],"Pedestrian",[["20",20],["350",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["0",20],["350",20],["0",20],["0",20],["0",20],["350",20]]],["agent_7",215.852511721815,275.9161486370256,0,10,0,[1,0,0],"Pedestrian",[["20",10],["350",12],["0",8],["350",8],["350",6],["0",8],["10",6],["350",8],["10",8],["0",8],["330",6],["20",4],["330",4],["290",2],["0",2],["340",2],["310",12],["350",10],["10",12],["0",10]]],["agent_8",706.6733718549372,435.7346620253011,0,10,3,[1,0,0],"Pedestrian",[["170",20],["0",20],["0",20],["10",20],["0",20],["0",20],["0",20],["0",20],["350",20],["0",20],["0",20],["0",20],["10",20],["0",20],["0",20],["0",20],["0",20]]],["agent_9",26.304738420797605,291.500671332719,0,10,12,[1,0,0],"Pedestrian",[["20",14],["350",14],["10",18],["350",20],["0",20],["350",20],["10",20],["0",20]]]]'),V=JSON.parse('[["agent_1",439.9990853590453,330.92009295239495,0,10,0,[1,0,0],"Pedestrian",[["350",18],["0",18],["0",18],["0",18],["350",20],["10",20],["0",20],["350",20],["10",20],["0",20],["0",20]]],["agent_10",60.83883503725798,237.06264398109784,0,10,0,[1,0,0],"Pedestrian",[["0",12],["350",14],["10",14],["350",12],["350",14],["10",12],["350",14],["20",4],["0",6],["350",6]]],["agent_11",51.811210029596396,252.98488978872854,0,10,0,[1,0,0],"Pedestrian",[["0",8],["10",8],["350",8],["10",8],["0",12],["360",8],["350",12],["350",12],["350",12],["10",12]]],["agent_12",32.80568369767724,253.8229027259723,0,10,0,[1,0,0],"Pedestrian",[["350",10],["0",8],["0",10],["350",8],["20",12],["350",10],["10",12],["350",12],["350",10],["0",10]]],["agent_13",19.976953423631812,275.1922326256872,0,10,0,[1,0,0],"Pedestrian",[["340",8],["10",10],["0",10],["350",8],["10",10],["20",10],["0",10],["350",10],["0",12],["350",14]]],["agent_14",554.0322433505602,185.94385480923057,0,10,0,[1,0,0],"Pedestrian",[["340",2],["350",2],["10",2],["0",2],["0",2],["350",2],["10",4],["0",2],["340",2],["20",2]]],["agent_15",525.0488156943835,196.83802299339897,0,10,0,[1,0,0],"Pedestrian",[["0",8],["10",10],["350",8],["0",2],["0",2],["10",4],["350",2],["0",2],["10",4],["10",4]]],["agent_16",496.06538803820683,185.10584187198685,0,10,0,[1,0,0],"Pedestrian",[["10",10],["0",10],["0",10],["310",4],["0",6],["10",4],["0",4],["350",4],["360",4],["350",4]]],["agent_17",726.9825329710246,546.2894178240324,0,10,2,[1,0,0],"Pedestrian",[["210",20],["350",20],["10",20],["0",20],["0",20],["0",20],["0",20],["0",20]]],["agent_18",711.3029737471913,434.8336971706169,0,10,3,[1,0,0],"Pedestrian",[["210",16],["0",18],["0",14],["340",14],["10",12],["340",14],["10",12]]],["agent_19",715.5792171718731,389.5809985594558,0,10,5,[1,0,0],"Pedestrian",[["160",8],["10",10],["350",8],["0",6],["330",4]]],["agent_2",548.8057236092825,273.93521321982166,0,10,0,[1,0,0],"Pedestrian",[["0",18],["0",18],["10",18],["350",18],["0",20],["0",20],["0",20],["10",20],["350",20]]],["agent_20",705.6013158476156,416.397412551255,0,10,9,[1,0,0],"Pedestrian",[["140",6]]],["agent_21",475.1593090730957,519.892010300855,0,10,0,[1,0,0],"Pedestrian",[["330",2],["350",4],["20",2],["350",2],["350",2],["10",4],["340",2],["60",20],["10",20],["350",20]]],["agent_213",219.05984175048505,112.19871633178275,0,10,0,[1,0,0],"Pedestrian",[["240",14],["0",14],["0",12],["340",12],["10",12],["350",14],["350",14],["0",14],["10",14],["350",14]]],["agent_214",198.15376278537394,113.03672926902647,0,10,0,[1,0,0],"Pedestrian",[["240",12],["350",12],["10",12],["340",12],["0",12],["360",12],["350",12],["0",14],["10",12],["350",14]]],["agent_215",231.88857202453045,157.03240847432204,0,10,0,[1,0,0],"Pedestrian",[["250",12],["10",12],["350",14],["0",12],["350",14],["350",14],["0",14],["340",16],["0",14],["10",16]]],["agent_216",211.93276937601533,164.99353137813745,0,10,0,[1,0,0],"Pedestrian",[["260",12],["360",14],["350",12],["0",12],["340",12],["10",10],["340",12],["350",12],["10",14],["350",12]]],["agent_217",374.9051576722221,387.0669597477246,0,10,0,[1,0,0],"Pedestrian",[["330",2],["still"],["0",2],["350",2],["20",2],["still"],["350",2],["0",2],["still"],["350",2]]],["agent_218",185.8001706696265,428.96760660991083,0,10,0,[1,0,0],"Pedestrian",[["200",4],["0",6],["0",4],["350",10],["0",10],["350",10],["0",12],["350",12],["0",14],["10",12]]],["agent_219",356.84990765689895,447.82289769789463,0,10,0,[1,0,0],"Pedestrian",[["270",2],["still"],["340",2],["10",2],["still"],["0",2],["10",2],["still"],["350",2],["350",2]]],["agent_22",452.8278156330907,563.8876895061505,0,10,0,[1,0,0],"Pedestrian",[["300",6],["350",6],["10",4],["0",6],["0",2],["10",4],["350",4],["60",8],["10",20],["0",20]]],["agent_220",400.08748006201506,410.11231552192703,0,10,0,[1,0,0],"Pedestrian",[["200",2],["still"],["350",2],["still"],["0",2],["0",2],["still"],["0",2],["still"],["0",2]]],["agent_23",49.910657396404474,418.4924448943643,0,10,1,[1,0,0],"Pedestrian",[["340",12],["0",10],["0",12],["350",12],["0",14],["350",14],["10",16],["10",20],["0",20]]],["agent_24",26.62888763980351,459.136072350685,0,10,4,[1,0,0],"Pedestrian",[["350",20],["350",20],["10",20],["0",20],["0",20],["10",20]]],["agent_25",531.2256117522574,45.157681352284726,0,10,0,[1,0,0],"Pedestrian",[["80",8],["10",10],["10",18],["0",16],["10",14],["0",12],["0",12],["20",14],["10",16],["0",16]]],["agent_273",723.1814277046408,268.0691226591157,0,10,0,[1,0,0],"Pedestrian",[["250",8],["0",6],["350",8],["10",8],["0",6],["0",8],["340",8],["10",8],["350",8],["20",10]]],["agent_274",723.1814277046408,214.01728820689533,0,10,7,[1,0,0],"Pedestrian",[["250",6],["0",6],["350",4]]],["agent_3",298.8830523445455,433.1576712961295,0,10,0,[1,0,0],"Pedestrian",[["310",20],["0",20],["350",20],["10",20],["10",20],["350",20],["20",20],["0",20],["10",20],["0",20]]],["agent_4",117.8554140330155,323.7969829858233,0,10,0,[1,0,0],"Pedestrian",[["330",10],["0",10],["10",10],["350",2],["0",2],["still"],["still"],["50",2],["still"],["290",2]]],["agent_409",546.9051709760906,394.1900697142962,0,10,0,[1,0,0],"Pedestrian",[["120",6],["0",8],["10",6],["20",10],["10",8],["350",10],["10",10],["350",10],["350",10],["350",8]]],["agent_5",659.9880526510095,309.96976952130194,0,10,0,[1,0,0],"Pedestrian",[["190",20],["0",20],["0",20],["0",20],["10",20],["0",20],["0",20],["350",20],["0",20],["0",20]]],["agent_6",680.8941316161206,351.0324034462444,0,10,0,[1,0,0],"Pedestrian",[["200",12],["350",12],["10",12],["350",10],["0",10],["360",8],["290",4],["20",4],["340",2],["0",4]]],["agent_7",659.0377763344136,483.8574539993749,0,10,0,[1,0,0],"Pedestrian",[["200",18],["0",20],["0",18],["20",20],["350",20],["10",20],["350",20],["0",20],["10",20],["340",20]]],["agent_74",627.678657886747,51.4427783816127,0,10,5,[1,0,0],"Pedestrian",[["110",4],["350",2],["0",4],["10",2],["40",6]]],["agent_75",27.104025798101475,229.10152107728237,0,10,5,[1,0,0],"Pedestrian",[["0",10],["350",10],["20",10],["340",8],["20",10]]],["agent_76",23.778058690015655,258.8509803494346,0,10,6,[1,0,0],"Pedestrian",[["0",12],["0",12],["0",12],["350",8]]],["agent_8",678.9935789829287,449.91793004100396,0,10,0,[1,0,0],"Pedestrian",[["190",18],["10",16],["350",18],["10",16],["350",18],["10",18],["10",14],["0",16],["0",14],["0",18]]],["agent_9",691.8223092569742,255.07992213183798,0,10,0,[1,0,0],"Pedestrian",[["250",10],["0",10],["0",10],["10",10],["330",4],["10",4],["10",2],["0",4],["350",4],["10",6]]]]');!function(e){e[e.Bookstore=0]="Bookstore",e[e.Students=1]="Students",e[e.Eth=2]="Eth",e[e.Hotel=3]="Hotel",e[e.Little=4]="Little",e[e.Zara=5]="Zara"}(X||(X={}));var H=[{image:"./models/bookstore.glb",width:1424,height:1088,scale:[260,280,310],position:[-20,0,-20],rotation:[0,0,0],name:"BookStore Empty",staticObjects:["bookstore"],enumName:X.Bookstore},{image:"./models/bookstore.glb",width:1424,height:1088,scale:[260,280,310],position:[-20,0,-20],rotation:[0,0,0],name:"Simon Bookstore",data:N,staticObjects:["simonTest"],enumName:X.Bookstore},{image:"./models/eth.glb",width:640,height:480,scale:[280,280,280],position:[0,-192,-20],rotation:[0,-Math.PI/2,0],name:"Simon ETH",data:D,staticObjects:["simonTest"],enumName:X.Eth},{image:"./models/hotel.glb",width:720,height:576,scale:[140,140,140],position:[0,4,40],rotation:[0,-Math.PI/2,0],name:"Simon HOTEL",data:B,staticObjects:["simonTest"],enumName:X.Hotel},{image:"./models/little.glb",width:1417,height:2019,scale:[280,280,280],position:[0,-9,-20],rotation:[0,0,0],name:"Simon LITTLE",data:N,staticObjects:["simonTest"],enumName:X.Little},{image:"./models/students.glb",width:720,height:576,scale:[140,140,140],position:[0,4,-80],rotation:[0,0,0],name:"Simon STUDENTS",data:V,staticObjects:["simonTest"],enumName:X.Students},{image:"./models/zara.glb",width:720,height:576,scale:[140,140,140],position:[0,60,-20],rotation:[0,0,0],name:"Simon ZARA",data:F,staticObjects:["simonTest"],enumName:X.Zara}],U=(0,C.Z)((function(e,t){return{time:0,minTime:1e6,maxTime:0,data:null,world:H[0],setWorld:function(t){return e((function(e){return{world:t}}))},setData:function(t){return e((function(e){return{data:t}}))},incrementTime:function(t){return e((function(e){return{time:e.time+t}}))},setTime:function(t){return e((function(e){return{time:t}}))},action:function(){return t().time},playActive:!1,setPlayActive:function(t){return e((function(e){return{playActive:t}}))},setMaxTime:function(t){return e((function(e){return{maxTime:t}}))},setMinTime:function(t){return e((function(e){return{minTime:t,time:t}}))},getPlayActive:function(){return t().playActive},resetState:function(){e((function(e){return{time:0,maxTime:0,minTime:1e6,data:null}}))}}}));function z(e,t,n,i,r){return e.subscribe({next:function(e){var n,i,r=e.raw;if(n=r,null!=(i=R)&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](n):n instanceof i){var o=r.position[0].time,a=r.position[r.position.length-1].time,s=t,l=function(e,t,n){for(var i=[],r=t;r<=n;r++)i.push({time:r,position:null,direction:null});return e.map((function(e){var n=e.time,r=e.position,o=e.direction;i[n-t].position=[r.x,r.y,r.z],i[n-t].direction=[o.x,o.y,o.z]})),i}(r.position,o,a),u={id:s,size:30,type:r.type,framePos:l,startT:o,endT:a,direction:[r.position[0].direction.x,r.position[0].direction.y,r.position[0].direction.z]},c=U.getState().data,d=U.getState().setData;if(d(null),c){var f=c.findIndex((function(e){return e.id===s}));-1!==f?(c[f]=u,d(c)):(c.push(u),d(c))}else d([u]);U.getState().maxTime<=a&&U.getState().setMaxTime(a+1),U.getState().minTime>o&&U.getState().setMinTime(o)}},error:function(e){r(e)}})}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function W(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function Q(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Z=new E([]);function J(){var e=(0,I.g4)((function(e){return e.descriptions}),Y.wU);return(0,i.jsx)(i.Fragment,{children:e.map((function(e,t){var n=e.seed,r=e.name;return(0,i.jsx)($,{seed:n,name:r,index:t},r)}))})}function $(e){var t=e.seed,n=e.name,r=(e.index,(0,I.EB)()),o=r((function(e){return e.selectedDescriptions.includes(n)})),a=r((function(e){var t;return null===(t=e.grammar.find((function(e){var t=e.name;return(0,Y.Lr)(n,t)})))||void 0===t?void 0:t.name}));return null==a?null:o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(re,{seed:t,name:n}),(0,i.jsx)(ee,{description:n})]}):(0,i.jsx)(ie,{seed:t,name:n})}var q=new u.SphereBufferGeometry;function K(e){var t=new u.Mesh(q);return W(e,R)&&t.position.copy(e.position[e.position.length-1].position),t}function ee(e){var t=e.description,n=(0,I.EB)(),r=U((function(e){return e.setTime})),o=n((function(e){if("gui"===e.type)return Array.from(new Set((null!=e.hovered?e.selectionsList.concat(e.hovered):e.selectionsList).filter((function(e){var n=e.steps;return(0,Y.Lr)(t,(0,Y.Il)(n)[0])})).reduce((function(e,t){var n,i,o=null===(n=t.values[0])||void 0===n?void 0:n.before.raw,a=null===(i=t.values[0])||void 0===i?void 0:i.after.raw;if("string"!=typeof t.steps&&"operation"==t.steps.type)if(t.steps.identifier.includes("move")&&o&&a){var s=a.position.slice(o.position.length)[0].time;r(s)}else if(null===o||void 0===o?void 0:o.position){var l=null===o||void 0===o?void 0:o.position[(null===o||void 0===o?void 0:o.position.length)-1].time;l&&r(l)}return e.concat(t.values.filter((function(e){return null!=e.object})).map((function(e){return e.object})))}),[])))}),Y.wU);return null==o?null:(0,i.jsx)(i.Fragment,{children:o.map((function(e){return(0,i.jsx)(te,{object:e,colorAdd:.25},e.uuid)}))})}function te(e){var t=e.object,n=e.colorAdd;return(0,g.useEffect)((function(){return t.traverse((function(e){"material"in e&&e.material.color.addScalar(n)})),function(){t.traverse((function(e){"material"in e&&e.material.color.addScalar(-n)}))}}),[t]),null}function ne(e,t){return e((function(e){return"gui"===e.type?(0,Y.Bc)(e.grammar,e.dependencyMap,t):void 0}),Y.wU)}function ie(e){var t=e.name,n=e.seed,r=(0,g.useRef)(null),o=(0,I.EB)();return function(e,t,n){var i=(0,I.EB)(),r=e&&e[0].name?e[0].name:"",o=Z,a=U((function(e){return e.world}));o.staticObjects=a.staticObjects,(0,g.useEffect)((function(){if(null!=n.current&&null!=e){var a=z((0,c.of)(o).pipe((0,Y.Tn)(),(0,Y.Ii)(e,p,{delay:i.getState().interpretationDelay,seed:t})),r,n.current,0,(function(e){console.error(e),M.D1.getState().setError(e.message)}));return function(){var e,t;null===(t=n.current)||void 0===t||(e=t).remove.apply(e,Q(n.current.children)),a.unsubscribe()}}}),[i,e,t,a])}(ne(o,t),n,r),(0,i.jsx)("group",{onClick:function(e){var n;null==e.intersections[0].object.userData.steps&&(e.stopPropagation(),o.getState().selectDescription(t,null!==(n=o.getState().shift)&&void 0!==n&&n))},ref:r})}function re(e){var t=e.name,n=e.seed,r=(0,I.EB)(),o=ne(r,t),a=(0,g.useRef)(null);return function(e,t,n,i){var r=(0,I.EB)(),o=U((function(e){return e.world}));(0,g.useEffect)((function(){if(null!=i.current&&null!=e){var a,s=new Map,l=new Map,u=new L.x,d=u.pipe((0,Y.br)(300)).subscribe((function(e){return r.getState().editIndices(e,!0)})),f=e&&e[0].name?e[0].name:"",m=Z;m.staticObjects=o.staticObjects;try{a=z((0,c.of)(m).pipe((0,Y.Tn)(),(0,Y.Ii)(e,p,{delay:r.getState().interpretationDelay,seed:n,listeners:{onAfterStep:function(e,t){var n=s.get(e),i=null===n||void 0===n?void 0:n.find((function(e){var n=(0,Y.Up)(t.index,e.index);return n===Y.J.Predecessor||n===Y.J.Equal}));null!=i&&u.next({steps:e,value:{after:t,before:i,object:W(t.raw,E)?K(t.raw):void 0}});var r=t.index.join(","),o=l.get(r);null!=o&&(o.path[0]!==e.path[0]||function(e,t){if(e===t)return!0;if(e.length<t.length)return!1;for(var n=0;n<t.length;n++)if(e[n]!=t[n])return!1;return!0}(o.path,e.path)&&(0,k.I)({},e))||l.set(r,e)},onBeforeStep:function(e,t){var n=s.get(e);if(null==n&&(n=[],s.set(e,n)),n.push(t),"symbol"===e.type){var i=t.index.join(",");l.delete(i)}}}})),f,i.current,0,(function(e){console.error(e),M.D1.getState().setError(e.message)}))}catch(g){M.D1.getState().setError(g.message)}return function(){var e,n;r.getState().clearValueMap(t),null===(n=i.current)||void 0===n||(e=n).remove.apply(e,Q(i.current.children)),null===a||void 0===a||a.unsubscribe(),null===d||void 0===d||d.unsubscribe()}}}),[r,e,n,o])}(o,t,n,a),null==o?null:(0,i.jsx)("object3D",{onPointerMove:function(e){if(0!==e.intersections.length){var t=e.intersections[0].object,n=t.userData.steps,i=t.userData.value;null!=n&&null!=i&&(e.stopPropagation(),r.getState().onStartHover(n,[i]))}},onPointerOut:function(e){var t=e.object,n=t.userData.steps,i=t.userData.value;null!=n&&null!=i&&(e.stopPropagation(),r.getState().onEndHover(n))},onClick:function(e){var t=e.intersections[0].object,n=t.userData.steps,i=t.userData.value;if(null!=n&&null!=i){e.stopPropagation();var o=r.getState();"gui"==o.type&&null==o.requested&&r.getState().selectResult(n,i)}},ref:a})}var oe=n(82409),ae=n(82359),se=(0,g.forwardRef)((function(e,t){var n=(0,g.useRef)(),r=(0,j.L)("./models/remyplace.glb"),o=r.scene,a=r.materials,l=r.animations,c=(0,g.useMemo)((function(){return ae.b.clone(o)}),[o]),d=(0,s.y)(c).nodes,f=(0,g.useMemo)((function(){return new u.AnimationMixer(c)}),[o]);return l.forEach((function(e){f.clipAction(e).play()})),(0,g.useImperativeHandle)(t,(function(){return{updatePosition:function(e,t,i,r,o){n.current.rotation.y=r,n.current.position.y=t+2,n.current.position.z=i,n.current.position.x=e,f.update(o)},hideObject:function(){n.current.visible=!1},showObject:function(){n.current.visible=!0}}})),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("group",{ref:n,dispose:null,children:(0,i.jsxs)("group",{name:"Armature",rotation:[Math.PI/2,0,0],scale:e.scale,children:[(0,i.jsx)("primitive",{object:d.mixamorigHips}),(0,i.jsx)("skinnedMesh",{geometry:d.Body.geometry,material:a.Bodymat,skeleton:d.Body.skeleton}),(0,i.jsx)("skinnedMesh",{geometry:d.Bottoms.geometry,material:a.Bottommat,skeleton:d.Bottoms.skeleton}),(0,i.jsx)("skinnedMesh",{geometry:d.Eyelashes.geometry,material:a.Eyelashmat,skeleton:d.Eyelashes.skeleton}),(0,i.jsx)("skinnedMesh",{geometry:d.Eyes.geometry,material:a.Bodymat,skeleton:d.Eyes.skeleton}),(0,i.jsx)("skinnedMesh",{geometry:d.Hair.geometry,material:a.Hairmat,skeleton:d.Hair.skeleton}),(0,i.jsx)("skinnedMesh",{geometry:d.Shoes.geometry,material:a.Shoesmat,skeleton:d.Shoes.skeleton}),(0,i.jsx)("skinnedMesh",{geometry:d.Tops.geometry,material:a.Topmat,skeleton:d.Tops.skeleton})]})})})}));j.L.preload("./models/remyplace.glb");var le=(0,g.forwardRef)((function(e,t){var n,r=(0,g.useRef)(),o=(0,j.L)("./models/cyclist.glb"),a=o.nodes,s=o.materials;return(0,g.useImperativeHandle)(t,(function(){return{updatePosition:function(e,t,n,i,o){r.current.rotation.y=i,r.current.position.z=n,r.current.position.x=e},hideObject:function(){r.current.visible=!1},showObject:function(){r.current.visible=!0}}})),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("group",{ref:null!==(n=r)&&void 0!==n?n:null,dispose:null,scale:e.scale,position:[0,e.positionY,0],children:(0,i.jsxs)("group",{rotation:[Math.PI/2,0,Math.PI/2],children:[(0,i.jsx)("mesh",{geometry:a.Chain_Chain_0.geometry,material:s.Chain_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.eyeball1_eyeball1_0.geometry,material:s.eyeball1}),(0,i.jsx)("mesh",{geometry:a.Frame_Frame_0.geometry,material:s.Frame_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.Handlebars_Handlebars_0.geometry,material:s.Handlebars_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.Rims_Rims_0.geometry,material:s.Rims_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.Saddle_Saddle_0.geometry,material:s.Saddle_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.Spokes_Spokes_0.geometry,material:s.Spokes_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.Tyres_Tyres_0.geometry,material:s.Tyres_COLOR_0}),(0,i.jsx)("mesh",{geometry:a.UMesh_Figure_1_UMesh_Figure_1_0.geometry,material:s.UMesh_Figure_1}),(0,i.jsx)("mesh",{geometry:a.UMesh_Figure_1_UMesh_Figure_1_0001.geometry,material:s.UMesh_Figure_1}),(0,i.jsx)("mesh",{geometry:a.UMesh_Figure_1_UMesh_Figure_1_0002.geometry,material:s.UMesh_Figure_1})]})})})}));j.L.preload("./models/cyclist.glb");var ue,ce=(0,g.forwardRef)((function(e,t){var n=(0,g.useRef)(),r=(0,j.L)("./models/truck.glb"),o=r.nodes,a=r.materials;return(0,g.useImperativeHandle)(t,(function(){return{updatePosition:function(e,t,i,r,o){n.current.rotation.y=r,n.current.position.y=t+2,n.current.position.z=i,n.current.position.x=e},hideObject:function(){n.current.visible=!1},showObject:function(){n.current.visible=!0}}})),(0,i.jsx)("group",{ref:n,dispose:null,scale:e.scale,children:(0,i.jsx)("group",{rotation:[-Math.PI/2,0,0],children:(0,i.jsxs)("group",{rotation:[Math.PI/2,0,0],children:[(0,i.jsx)("group",{position:[3.78,64.77,.21],rotation:[0,-Math.PI/2,0],scale:[.91,.85,.85],children:(0,i.jsx)("group",{position:[10.19,-20.82,144.24],children:(0,i.jsx)("mesh",{geometry:o.BODY_BODY_0.geometry,material:a.BODY})})}),(0,i.jsx)("group",{position:[-86.39,57.34,.45],rotation:[0,-Math.PI/2,0],scale:.85,children:(0,i.jsx)("group",{position:[-1.3,-28.61,42.95],children:(0,i.jsx)("mesh",{geometry:o.interior_VOID_0.geometry,material:a.VOID})})}),(0,i.jsx)("group",{position:[8.64,20.85,.44],rotation:[Math.PI/2,0,-Math.PI],scale:1.31,children:(0,i.jsxs)("group",{position:[71.49,-.58,15.66],children:[(0,i.jsx)("mesh",{geometry:o.bottom_BOTTOM_0.geometry,material:a.BOTTOM}),(0,i.jsx)("mesh",{geometry:o["bottom_07_-_Default_0"].geometry,material:a["07_-_Default"]})]})}),(0,i.jsx)("group",{position:[-.79,30.87,.21],rotation:[0,-Math.PI/2,0],scale:[.91,.85,.85],children:(0,i.jsxs)("group",{position:[10.19,19.01,138.87],children:[(0,i.jsx)("mesh",{geometry:o.LIGHTS_LIGHT_0.geometry,material:a.LIGHT}),(0,i.jsx)("mesh",{geometry:o.LIGHTS_LIGHTS_GLASS_0.geometry,material:a.LIGHTS_GLASS})]})}),(0,i.jsx)("group",{position:[-91.96,64.56,.21],rotation:[0,-Math.PI/2,0],scale:[.91,.85,.85],children:(0,i.jsx)("group",{position:[10.19,-20.58,29.64],children:(0,i.jsx)("mesh",{geometry:o.GLASS_GLASS_0.geometry,material:a.GLASS})})}),(0,i.jsx)("group",{position:[-89.58,62.39,.21],children:(0,i.jsxs)("group",{position:[23.2,-13.96,42.09],children:[(0,i.jsx)("mesh",{geometry:o.CABIN_PLASTIC_PLASTIC_0.geometry,material:a.PLASTIC}),(0,i.jsx)("mesh",{geometry:o.CABIN_PLASTIC_METALL_0.geometry,material:a.METALL})]})}),(0,i.jsx)("group",{position:[37.58,72.49,.21],children:(0,i.jsx)("group",{position:[1.78,0,46.74],children:(0,i.jsx)("mesh",{geometry:o.BOX_METAL_METALL_0.geometry,material:a.METALL})})}),(0,i.jsx)("group",{position:[-80.35,14.59,38.22],rotation:[-Math.PI/2,0,0],scale:1.11,children:(0,i.jsxs)("group",{position:[0,-.89,0],children:[(0,i.jsx)("mesh",{geometry:o.wheel_01_RIM_0.geometry,material:a.material}),(0,i.jsx)("mesh",{geometry:o.wheel_01_TIRE_0.geometry,material:a.TIRE})]})}),(0,i.jsx)("group",{position:[65.15,14.59,34.8],rotation:[-Math.PI/2,0,0],scale:1.11,children:(0,i.jsxs)("group",{position:[0,-3.96,0],children:[(0,i.jsx)("mesh",{geometry:o.wheel_02_TIRE_0.geometry,material:a.TIRE}),(0,i.jsx)("mesh",{geometry:o.wheel_02_RIM_0.geometry,material:a.material})]})}),(0,i.jsx)("group",{position:[65.15,14.59,-34.49],rotation:[Math.PI/2,0,0],scale:1.11,children:(0,i.jsxs)("group",{position:[0,-3.96,0],children:[(0,i.jsx)("mesh",{geometry:o.wheel_003_TIRE_0.geometry,material:a.TIRE}),(0,i.jsx)("mesh",{geometry:o.wheel_003_RIM_0.geometry,material:a.material})]})}),(0,i.jsx)("group",{position:[-80.35,14.59,-37.92],rotation:[Math.PI/2,0,0],scale:1.11,children:(0,i.jsxs)("group",{position:[0,-.89,0],children:[(0,i.jsx)("mesh",{geometry:o.wheel_004_RIM_0.geometry,material:a.material}),(0,i.jsx)("mesh",{geometry:o.wheel_004_TIRE_0.geometry,material:a.TIRE})]})}),(0,i.jsx)("group",{position:[-111.5,16.83,.21],scale:[.85,.85,.91],children:(0,i.jsx)("group",{position:[9.52,-2.51,48.36],children:(0,i.jsx)("mesh",{geometry:o.BUMPER_FRONT_INNER_BOTTOM_0.geometry,material:a.BOTTOM})})}),(0,i.jsx)("group",{position:[-111.5,16.83,.21],scale:[.85,.85,.91],children:(0,i.jsx)("group",{position:[9.52,-2.51,48.36],children:(0,i.jsx)("mesh",{geometry:o.BUMPER_FRONT_PLASTIC_0.geometry,material:a.PLASTIC})})})]})})})}));function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fe(e,t){switch(t){case S.Cyclist:return[pe[e].cyclist.lineOffsetX,pe[e].cyclist.lineOffsetY,pe[e].cyclist.lineLength,pe[e].cyclist.textMarginX,pe[e].cyclist.textMarginY,pe[e].cyclist.positionY,pe[e].cyclist.rotationY,pe[e].cyclist.objectScale];case S.Pedestrian:return[pe[e].pedestrian.lineOffsetX,pe[e].pedestrian.lineOffsetY,pe[e].pedestrian.lineLength,pe[e].pedestrian.textMarginX,pe[e].pedestrian.textMarginY,pe[e].pedestrian.positionY,pe[e].pedestrian.rotationY,pe[e].pedestrian.objectScale];case S.Car:return[pe[e].truck.lineOffsetX,pe[e].truck.lineOffsetY,pe[e].truck.lineLength,pe[e].truck.textMarginX,pe[e].truck.textMarginY,pe[e].truck.positionY,pe[e].truck.rotationY,pe[e].truck.objectScale];default:return[pe[e].pedestrian.lineOffsetX,pe[e].pedestrian.lineOffsetY,pe[e].pedestrian.lineLength,pe[e].pedestrian.textMarginX,pe[e].pedestrian.textMarginY,pe[e].pedestrian.positionY,pe[e].pedestrian.rotationY,pe[e].pedestrian.objectScale]}}j.L.preload("./models/truck.glb");var pe=(de(ue={},X.Bookstore,{pedestrian:{lineOffsetX:0,lineOffsetY:20,lineLength:50,textMarginX:-10,textMarginY:50,positionY:0,rotationY:Math.PI/2,objectScale:.095},cyclist:{lineOffsetX:0,lineOffsetY:25,lineLength:50,textMarginX:-10,textMarginY:55,positionY:14,rotationY:Math.PI/2,objectScale:8},truck:{lineOffsetX:50,lineOffsetY:30,lineLength:120,textMarginX:-10,textMarginY:85,positionY:0,rotationY:Math.PI,objectScale:.6}}),de(ue,X.Eth,{pedestrian:{lineOffsetX:0,lineOffsetY:25,lineLength:50,textMarginX:-10,textMarginY:60,positionY:0,rotationY:Math.PI/2,objectScale:.12},cyclist:{lineOffsetX:0,lineOffsetY:35,lineLength:50,textMarginX:-10,textMarginY:60,positionY:20,rotationY:Math.PI/2,objectScale:10},truck:{lineOffsetX:50,lineOffsetY:40,lineLength:180,textMarginX:-10,textMarginY:120,positionY:0,rotationY:Math.PI,objectScale:.9}}),de(ue,X.Students,{pedestrian:{lineOffsetX:0,lineOffsetY:30,lineLength:50,textMarginX:-10,textMarginY:65,positionY:0,rotationY:Math.PI/2,objectScale:.14},cyclist:{lineOffsetX:0,lineOffsetY:15,lineLength:50,textMarginX:-10,textMarginY:65,positionY:20,rotationY:Math.PI/2,objectScale:10},truck:{lineOffsetX:50,lineOffsetY:40,lineLength:180,textMarginX:-10,textMarginY:120,positionY:0,rotationY:Math.PI,objectScale:.9}}),de(ue,X.Hotel,{pedestrian:{lineOffsetX:0,lineOffsetY:40,lineLength:50,textMarginX:-10,textMarginY:115,positionY:0,rotationY:Math.PI/2,objectScale:.175},cyclist:{lineOffsetX:0,lineOffsetY:15,lineLength:50,textMarginX:-10,textMarginY:85,positionY:23,rotationY:Math.PI/2,objectScale:14},truck:{lineOffsetX:50,lineOffsetY:40,lineLength:180,textMarginX:-10,textMarginY:120,positionY:0,rotationY:Math.PI,objectScale:.9}}),de(ue,X.Zara,{pedestrian:{lineOffsetX:0,lineOffsetY:30,lineLength:50,textMarginX:-10,textMarginY:70,positionY:0,rotationY:Math.PI/2,objectScale:.15},cyclist:{lineOffsetX:0,lineOffsetY:35,lineLength:80,textMarginX:-10,textMarginY:80,positionY:22,rotationY:Math.PI/2,objectScale:13},truck:{lineOffsetX:50,lineOffsetY:40,lineLength:180,textMarginX:-10,textMarginY:120,positionY:0,rotationY:Math.PI,objectScale:.9}}),de(ue,X.Little,{pedestrian:{lineOffsetX:0,lineOffsetY:60,lineLength:50,textMarginX:-10,textMarginY:115,positionY:0,rotationY:Math.PI/2,objectScale:.095},cyclist:{lineOffsetX:0,lineOffsetY:15,lineLength:50,textMarginX:-10,textMarginY:60,positionY:0,rotationY:Math.PI/2,objectScale:.095},truck:{lineOffsetX:50,lineOffsetY:20,lineLength:120,textMarginX:-10,textMarginY:120,positionY:0,rotationY:Math.PI,objectScale:.9}}),ue);function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(l){s=!0,r=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e){var t=(0,g.useRef)(),n=e.data,r=e.world.enumName,o=e.type,a=ge(fe(r,o),8),s=(a[0],a[1],a[2],a[3],a[4],a[5]),l=(a[6],a[7]),u=(0,g.useMemo)((function(){switch(o){case S.Cyclist:return(0,i.jsx)(le,{id:e.id,ref:t,scale:l,positionY:s},e.id);case S.Pedestrian:return(0,i.jsx)(se,{id:e.id,ref:t,scale:l,positionY:s},e.id);case S.Car:return(0,i.jsx)(ce,{id:e.id,ref:t,scale:l,positionY:s},e.id);default:return(0,i.jsx)(se,{id:e.id,ref:t,scale:l,positionY:s},e.id)}}),[e]);return(0,g.useEffect)((function(){if(n){var e=n.position,i=n.direction;t.current.updatePosition(e[0],e[1],e[2],-Math.atan2(i[2],i[0])+Math.PI/2,Math.round(500*Math.random()))}}),[t,e]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(g.Suspense,{fallback:null,children:u})})}var ye=function(){var e=(0,s.w)(),t=e.camera,n=e.gl;return(0,g.useEffect)((function(){t.rotateX(-Math.PI/10),t.position.set(3,200,400),t.rotateX(-Math.PI/10)}),[t,n]),null};function xe(e){var t=U((function(e){return e.data})),n=U((function(e){return e.time})),r=U((function(e){return e.world})),o=U((function(e){return e.setTime})),s=U((function(e){return e.minTime})),l=U((function(e){return e.maxTime})),u=!!t,c=(0,g.useState)(!1),d=c[0],f=c[1],p=(0,g.useState)(0),m=p[0],h=p[1];return(0,i.jsx)(i.Fragment,{children:u?(0,i.jsxs)("div",{style:{position:"absolute",top:"80%",zIndex:"10000",marginLeft:"10%",marginRight:"10%",width:"80%",height:"5%",color:"white"},children:["Time : ",n,d?(0,i.jsxs)(a.Xz,{style:{position:"absolute",bottom:"75%",zIndex:"10000",marginLeft:d-220+"px",width:"500px",height:"350px",border:"4px solid mediumgray"},children:[(0,i.jsx)("axesHelper",{}),(0,i.jsx)(w,{world:r}),"(",(0,i.jsx)(i.Fragment,{children:t?t.map((function(e){var t;return(0,i.jsx)(he,{id:e.id,data:null!==(t=e.framePos[m])&&void 0!==t?t:null,world:r,type:e.type},e.id)})):null}),") ",(0,i.jsx)(ye,{})]}):null,(0,i.jsxs)("div",{children:[(0,i.jsx)(oe.ZP,{step:1,min:s,max:l,value:n,onChangeCommitted:function(e,t){U.getState().setPlayActive(!0),o(t),U.getState().setPlayActive(!1),f(!1)},onChange:function(e,t){"mousemove"==e.type?(f(e.clientX),h(t)):(f(!1),h(0))},valueLabelDisplay:"auto"}),(0,i.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,i.jsx)("button",{onClick:function(){U.getState().setPlayActive(!0)},children:"Play"}),(0,i.jsx)("button",{onClick:function(){U.getState().setPlayActive(!1)},children:"Pause"}),(0,i.jsx)("button",{onClick:function(){U.getState().setPlayActive(!1),o(0)},children:"Reset"})]})]})]}):null})}var ve=n(39240),je=(0,g.forwardRef)((function(e,t){var n=(0,g.useState)((function(){return new u.Scene}))[0],r=(0,g.useRef)();return(0,g.useImperativeHandle)(t,(function(){return{updatePosition:function(e,t,n){r.current.position.x=e,r.current.position.y=t,r.current.position.z=n},hideText:function(){r.current.visible=!1},showText:function(){r.current.visible=!0}}})),(0,g.useLayoutEffect)((function(){var t=new ve.xv;return n.add(t),t.text=e.text,t.fontSize=5,t.color=0,function(){}}),[]),(0,i.jsx)("primitive",{object:n,ref:r})}));function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _e(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Pe(e,t,n){return Pe=_e()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&we(r,n.prototype),r},Pe.apply(null,arguments)}function we(e,t){return we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},we(e,t)}function Se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(l){s=!0,r=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||Me(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Me(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,t){if(e){if("string"===typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function Te(e){var t=(0,g.useRef)(),n=(0,g.useRef)(),r=((0,g.useRef)(),e.data.type),o=(S.Car,Se(fe(e.world.enumName,r),8)),a=(o[0],o[1]),l=o[2],c=o[3],d=o[4],f=o[5],p=o[6],m=o[7],h=(0,g.useMemo)((function(){switch(r){case S.Cyclist:return(0,i.jsx)(le,{id:e.id,ref:t,scale:m,positionY:f},e.id);case S.Pedestrian:return(0,i.jsx)(se,{id:e.id,ref:t,scale:m,positionY:f},e.id);case S.Car:return(0,i.jsx)(ce,{id:e.id,ref:t,scale:m,positionY:f},e.id);default:return(0,i.jsx)(se,{id:e.id,ref:t,scale:m,positionY:f},e.id)}}),[e]),y=(0,g.useRef)(),x=e.data;return(0,g.useEffect)((function(){if(t.current&&x.framePos.length>0){var e=x.framePos[0];if(e.position){var i=e.position[0],r=e.position[1],o=e.position[2];t.current.updatePosition(i,r,o,p,0),n.current.updatePosition(i+c,r+d,o)}}}),[t,e]),(0,s.x)((function(e,i){var r=U.getState().time;if(x.startT<=r&&r<=x.endT&&x.framePos){var o=r-x.startT,s=x.framePos[o],f=s.direction;if(s.position&&t.current&&y.current&&f){t.current.showObject(),y.current.visible=!0,n.current.showText();var m=s.position[0],g=s.position[1],h=s.position[2],v=-Math.atan2(f[2],f[0])+p;t.current.updatePosition(m,g,h,v,i),n.current.updatePosition(m+c,g+d,h);var j=[m,a,h],b=[m+f[0]*l,a+2,h+f[2]*l];y.current.geometry.setFromPoints([j,b].map((function(e){return Pe(u.Vector3,Oe(e))})))}}else t.current.hideObject(),y.current.visible=!1,n.current.hideText()})),(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(g.Suspense,{fallback:null,children:h}),(0,i.jsx)(je,{text:e.id,ref:n}),(0,i.jsxs)("line",{ref:y,children:[(0,i.jsx)("bufferGeometry",{}),(0,i.jsx)("lineBasicMaterial",{attach:"material",color:"#9c88ff",linewidth:100})]})]})}var Ie=n(11163);function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){Ye(e,t,n[t])}))}return e}function ke(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(0,l.FP)(0,18);function Ae(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.default,{children:[(0,i.jsx)("title",{children:"CGV | Shape Editorrrrrrrrrrrrrrrrr"}),(0,i.jsx)("meta",{name:"description",content:""}),(0,i.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,i.jsx)(I.gb,{store:(0,h.i)(p,[Y.Ao,Y.Ug,Y.TO,Y.au,Y.W9,Y.z$]),Viewer:Xe,operationGuiMap:{},operations:p,children:(0,i.jsx)(T.M,{})})]})}var Ee=function(e){var t=U((function(e){return e.data}));return(0,i.jsx)(i.Fragment,{children:t?t.map((function(t){return(0,i.jsx)(Te,{id:t.id,data:t,world:e.world},t.id)})):null})},Re=function(e,t,n,i,r){var o=H[t];if(e.getState().deleteAllDescription(),n(),o.data){var a=[],s=!0,l=!1,u=void 0;try{for(var c,d=o.data[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p="ID"+f[0],m=f[1],g=f[2],h=f[3],y=(f[4],f[5]*A),x=f[6],v=De(f[7]),j=f[8],b=o.width,_=o.height,P=Ne(p,m,g,h,y,v,x,j,null!==b&&void 0!==b?b:0,null!==_&&void 0!==_?_:0);a.push(P)}}catch(w){l=!0,u=w}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}e.getState().addDescriptions(a)}i(t),r(o)};function Xe(e){var t=e.className,s=e.children,l=ke(e,["className","children"]),u=(0,r.j)(I.op),c=(0,I.EB)(),d=U((function(e){return e.world})),f=U((function(e){return e.setWorld})),p=U((function(e){return e.resetState})),m=(0,g.useState)(),h=m[0],y=m[1],v=(0,Ie.useRouter)();return(0,g.useEffect)((function(){var e=v.query.data;if(e)switch(e){case"bookstore":Re(c,1,p,y,f);break;case"eth":Re(c,2,p,y,f);break;case"hotel":Re(c,3,p,y,f);break;case"little":Re(c,4,p,y,f);break;case"students":Re(c,5,p,y,f);break;case"zara":Re(c,6,p,y,f)}}),[v]),(0,i.jsx)(g.Suspense,{fallback:null,children:(0,i.jsxs)("div",Le({onDragOver:function(e){return e.preventDefault()},onDrop:O.zf.bind(null,c)},l,{className:"".concat(t," position-relative"),children:[(0,i.jsxs)(a.Xz,{style:{touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},events:function(e){return Le({},(0,a.U3)(e),{priority:1,filter:function(e){return M.D1.getState().controlling?[]:e.sort((function(e,t){return e.distance-t.distance}))}})},dpr:null==n.g.window?1:window.devicePixelRatio,children:[(0,i.jsxs)(u,{children:[(0,i.jsx)("axesHelper",{}),(0,i.jsx)(J,{}),(0,i.jsx)(g.Suspense,{fallback:null,children:(0,i.jsx)(w,{world:d})}),(0,i.jsx)(Ce,{}),(0,i.jsx)(o.c,{makeDefault:!0,far:1e4}),(0,i.jsx)(x,{})]}),(0,i.jsx)(Ee,{world:d})]}),(0,i.jsx)(xe,{}),(0,i.jsxs)("div",{className:"d-flex flex-row justify-content-between position-absolute",style:{pointerEvents:"none",inset:0,left:0,right:0,top:0,bottom:0},children:[(0,i.jsxs)("div",{className:"d-flex flex-column my-3 ms-3",style:{maxWidth:200},children:[(0,i.jsxs)("div",{style:{pointerEvents:"all"},className:"bg-light rounded shadow w-100 overflow-hidden border d-flex flex-column",children:[(0,i.jsx)("div",{className:"w-100 mt-2",children:"Select Data"}),(0,i.jsx)("div",{className:"px-3 py-2 border-bottom d-flex flex-row align-items-center",children:(0,i.jsx)("select",{value:h,onChange:function(e){Re(c,e.target.value,p,y,f)},className:"form-select",children:H.map((function(e,t){return(0,i.jsx)("option",{value:t,children:e.name},e.name)}))})})]}),(0,i.jsx)("div",{className:"flex-grow-1"}),(0,i.jsx)("div",{style:{pointerEvents:"all"},className:"d-flex flex-row"})]}),(0,i.jsxs)("div",{className:"d-flex flex-column align-items-end m-3",children:[(0,i.jsx)(k.X,{className:"bg-light border rounded shadow w-100 mb-3 overflow-hidden",style:{maxWidth:"16rem",pointerEvents:"all"}}),(0,i.jsx)("div",{className:"flex-grow-1"})]})]}),s]}))})}var Ce=function(){U((function(e){return e.data}));var e=U((function(e){return e.maxTime}));return(0,s.x)((function(t){t.clock;U.getState().getPlayActive()&&U.getState().time<e&&U.getState().incrementTime(1)})),null};function Ne(e,t,n,i,r,o,a,s,l,u){var c={name:e,step:{type:"sequential",children:[{type:"this"},{type:"operation",children:[{type:"operation",identifier:"point3",children:[{type:"raw",value:t-l/2},{type:"raw",value:i},{type:"raw",value:n-u/2}]},{type:"raw",value:r},{type:"raw",value:o},{type:"operation",identifier:"point3",children:[{type:"raw",value:a[0]},{type:"raw",value:a[1]},{type:"raw",value:a[2]}]}],identifier:"createOb"}]}},d=!0,f=!1,p=void 0;try{for(var m,g=s[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var h=m.value;if(1==h.length){c.step.children.push({type:"operation",children:[],identifier:"standStill"})}else{var y={type:"operation",children:[{type:"raw",value:parseInt(h[0])},{type:"raw",value:h[1]}],identifier:"moveRotate"};c.step.children.push(y)}}}catch(x){f=!0,p=x}finally{try{d||null==g.return||g.return()}finally{if(f)throw p}}return c}function De(e){switch(e){case"Pedestrian":default:return 0;case"Biker":return 1}}}},function(e){e.O(0,[429,770,972,761,433,774,888,179],(function(){return t=45301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);